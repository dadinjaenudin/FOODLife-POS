{% extends 'management/base.html' %}

{% block title %}{% if is_edit %}Edit Terminal{% else %}Create Terminal{% endif %} - Management{% endblock %}

{% block content %}
<div class="container mx-auto px-4 py-1.5">
    <div class="flex justify-between items-center mb-1.5">
        <div>
            <h1 class="text-xl font-bold text-gray-800">{% if is_edit %}Edit Terminal{% else %}Create Terminal{% endif %}</h1>
            <p class="text-xs text-gray-600">Terminal configuration for this store</p>
        </div>
        <a href="{% url 'management:terminals' %}" class="px-2.5 py-1.5 bg-gray-600 hover:bg-gray-700 text-white rounded-lg transition-colors text-xs">
            ‚Üê Back to Terminals
        </a>
    </div>

    {% if messages %}
    <div class="mb-2 space-y-2">
        {% for message in messages %}
        <div class="px-3 py-2 rounded-lg text-xs border
            {% if message.tags == 'error' %}bg-red-50 border-red-200 text-red-700
            {% elif message.tags == 'success' %}bg-green-50 border-green-200 text-green-700
            {% else %}bg-blue-50 border-blue-200 text-blue-700{% endif %}">
            {{ message }}
        </div>
        {% endfor %}
    </div>
    {% endif %}

    {% if error %}
    <div class="bg-red-50 border border-red-200 text-red-700 px-3 py-2 rounded-lg mb-2 text-xs">
        {{ error }}
    </div>
    {% endif %}

    <div class="bg-white rounded-lg shadow p-4">
        <form method="post" class="grid grid-cols-1 md:grid-cols-2 gap-3">
            {% csrf_token %}
            <div>
                <label class="block text-xs font-medium text-gray-700 mb-0.5">Terminal Code</label>
                <input type="text" name="terminal_code" value="{{ terminal.terminal_code|default:'' }}" required
                       class="w-full px-2.5 py-1.5 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            </div>
            <div>
                <label class="block text-xs font-medium text-gray-700 mb-0.5">Terminal Name</label>
                <input type="text" name="terminal_name" value="{{ terminal.terminal_name|default:'' }}" required
                       class="w-full px-2.5 py-1.5 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent">
            </div>
            <div>
                <label class="block text-xs font-medium text-gray-700 mb-0.5">Device Type</label>
                <select name="device_type" required
                        class="w-full px-2.5 py-1.5 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    <option value="">Select device type</option>
                    {% for value, label in device_types %}
                    <option value="{{ value }}" {% if terminal.device_type == value %}selected{% endif %}>{{ label }}</option>
                    {% endfor %}
                </select>
            </div>
            <div>
                <label class="block text-xs font-medium text-gray-700 mb-0.5">Brand</label>
                <select name="brand" class="w-full px-2.5 py-1.5 text-xs border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500">
                    <option value="">Default Store Brand</option>
                    {% for sb in store_brands %}
                    <option value="{{ sb.brand.id }}" {% if terminal.brand_id == sb.brand.id %}selected{% endif %}>{{ sb.brand.name }}</option>
                    {% endfor %}
                </select>
            </div>
            <div class="md:col-span-2">
                <label class="inline-flex items-center text-xs text-gray-700">
                    <input type="checkbox" name="is_active" class="mr-2" {% if terminal.is_active or not is_edit %}checked{% endif %}>
                    Active terminal
                </label>
            </div>
            <div class="md:col-span-2 flex justify-end gap-2">
                <a href="{% url 'management:terminals' %}" class="px-3 py-1.5 bg-gray-100 text-gray-700 rounded-lg text-xs">Cancel</a>
                <button type="submit" class="px-3 py-1.5 bg-blue-600 hover:bg-blue-700 text-white rounded-lg text-xs font-semibold">
                    {% if is_edit %}Save Changes{% else %}Create Terminal{% endif %}
                </button>
            </div>
        </form>
    </div>
</div>
{% endblock %}
